SELECT NationalIDNumber, JobTitle, HireDate
FROM HumanResources.Employee
WHERE BusinessEntityID IN
   (SELECT BusinessEntityID
     FROM HumanResources.EmployeeDepartmentHistory
   )
ORDER BY JobTitle;
 
SELECT BusinessEntityID,NationalIDNumber, JobTitle, HireDate
FROM HumanResources.Employee
WHERE BusinessEntityID IN
   (SELECT BusinessEntityID
     FROM HumanResources.EmployeeDepartmentHistory
   )
ORDER BY JobTitle;
 
SELECT BusinessEntityID,NationalIDNumber, JobTitle, HireDate
FROM HumanResources.Employee
WHERE BusinessEntityID IN
   (SELECT BusinessEntityID
     FROM HumanResources.EmployeeDepartmentHistory
	 WHERE BusinessEntityID <= 100
   )
ORDER BY JobTitle;


SELECT Min(UnitPrice)
FROM Purchasing.PurchaseOrderDetail
WHERE UnitPrice IN
  (SELECT TOP 2 UnitPrice
   FROM Purchasing.PurchaseOrderDetail
   ORDER BY UnitPrice DESC
  );
 
SELECT Min(UnitPrice)
FROM Purchasing.PurchaseOrderDetail
WHERE UnitPrice IN
  (SELECT TOP 3 UnitPrice
   FROM Purchasing.PurchaseOrderDetail
   ORDER BY UnitPrice DESC
  );
 
SELECT Min(UnitPrice)
FROM Purchasing.PurchaseOrderDetail
WHERE UnitPrice IN
  (SELECT TOP 3 UnitPrice
   FROM Purchasing.PurchaseOrderDetail
   GROUP BY UnitPrice
   ORDER BY UnitPrice DESC
  );
 
 
SELECT PurchaseOrderID, UnitPrice
FROM Purchasing.PurchaseOrderDetail
WHERE UnitPrice >
 (SELECT Avg(ListPrice)
  FROM Production.Product
 );
 
SELECT PurchaseOrderID, UnitPrice
FROM Purchasing.PurchaseOrderDetail
WHERE UnitPrice <
 (SELECT Avg(ListPrice)
  FROM Production.Product
 );
